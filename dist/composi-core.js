(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.composi={})})(this,function(a){"use strict";function b(a,b,c,d,e,f){return e||(e=null),{type:a,props:b,children:c,element:d,key:e,flag:f}}function c(a,c){return c||(c=null),b(a,w,x,c,null,3)}function d(a){return"string"==typeof a&&(a=document.querySelector(a)),f(a),b(a.nodeName.toLowerCase(),w,x.map.call(a.childNodes,e),a,null,0)}function e(a){return 3===a.nodeType?c(a.nodeValue,a):d(a)}function f(a){for(var b,c=0;c<a.childNodes.length;c++)b=a.childNodes[c],8!==b.nodeType&&(3!==b.nodeType||/\S/.test(b.nodeValue))?1===b.nodeType&&f(b):(a.removeChild(b),c--)}function g(...a){function c(a,b=new WeakMap){if(Object(a)!==a)return a;if(b.has(a))return b.get(a);const d=a instanceof Date?new Date(a):a instanceof RegExp?new RegExp(a.source,a.flags):a.constructor?new a.constructor:Object.create(null);return b.set(a,d),Object.assign(d,...Object.keys(a).map(d=>({[d]:c(a[d],b)})))}return(Array.isArray(a[0])?a.unshift([]):a.unshift({}),Array.isArray(a[0]))?a.reduce((d,a)=>Array.prototype.concat(d,c(a))):"object"==typeof a[0]?a.reduce((d,a)=>Object.assign(d,c(a))):void 0}function h(a){return a.currentTarget.events[a.type](a)}function i(a){return null==a?null:a.key}function j(a,b,c){for(var d,e,f={};b<=c;)null!=(d=(e=a[b]).key)&&(f[d]=e),b++;return f}function k(a,b,c,d,e){if("key"!==b)if("style"===b&&"object"==typeof d)for(var f in g(c,d)){var i=null==d||null==d[f]?"":d[f];"-"===f[0]?a[b].setProperty(f,i):a[b][f]=i}else if("o"===b[0]&&"n"===b[1])b=b.slice(2).toLowerCase(),a.events||(a.events={}),a.events[b]=d,null==d?a.removeEventListener(b,h):null==c&&a.addEventListener(b,h);else{"list"!==b&&b in a&&!e?a[b]=null==d?"":d:null==d||!1===d?a.removeAttribute(b):"xlink-href"===b||"xlinkHref"===b?(a.setAttributeNS("http://www.w3.org/1999/xlink","href",d),a.setAttribute("href",d)):a.setAttribute(b,d)}}function l(a,b){var c=3===a.flag?document.createTextNode(a.type):(b=b||"svg"===a.type)?document.createElementNS("http://www.w3.org/2000/svg",a.type):document.createElement(a.type);var d=a.props;d.onmount&&y.push(function(){d.onmount(c)});for(var e=0,f=a.children.length;e<f;)c.appendChild(l(a.children[e],b)),e++;for(var g in d)k(c,g,null,d[g],b);return a.element=c}function m(a){for(var b=0,c=a.children.length;b<c;)m(a.children[b]),b++;return a.element}function n(a,b){var c=function(){a.removeChild(m(b))},d=b.props&&b.props.onunmount;null==d?c():d(c,b.element)}function o(a,b,c,d){for(var e in g(b,c))("value"==e||"checked"==e?a[e]:b[e])!==c[e]&&k(a,e,b[e],c[e],d);var f=a.vnode&&Reflect.get(a.vnode,"type")===0?c.onmount:c.onupdate;null!=f&&y.push(function(){f(a,b,c)})}function p(a,b,c,d,e){if(d===c);else if(null!=c&&3===c.flag&&3===d.flag)c.type!==d.type&&(b.nodeValue=d.type);else if(null==c||c.type!==d.type){var f=a.insertBefore(l(d,e),b);null!=c&&n(a,c),b=f}else{o(b,c.props,d.props,e=e||"svg"===d.type);for(var g,h,k,m,q=c.children,r=0,s=q.length-1,t=d.children,u=0,v=t.length-1;u<=v&&r<=s&&(k=i(q[r]),m=i(t[u]),null!=k&&k===m);)p(b,q[r].element,q[r],t[u],e),r++,u++;for(;u<=v&&r<=s&&(k=i(q[s]),m=i(t[v]),null!=k&&k===m);)p(b,q[s].element,q[s],t[v],e),s--,v--;if(r>s)for(;u<=v;)b.insertBefore(l(t[u++],e),(h=q[r])&&h.element);else if(u>v)for(;r<=s;)n(b,q[r++]);else{for(var w=j(q,r,s),x={};u<=v;){if(k=i(h=q[r]),m=i(t[u]),x[k]||null!=m&&m===i(q[r+1])){null==k&&n(b,h),r++;continue}null==m||0===c.flag?(null==k&&(p(b,h&&h.element,h,t[u],e),u++),r++):(k===m?(p(b,h.element,h,t[u],e),x[m]=!0,r++):null==(g=w[m])?p(b,h&&h.element,null,t[u],e):(p(b,b.insertBefore(g.element,h&&h.element),g,t[u],e),x[m]=!0),u++)}for(;r<=s;)null==i(h=q[r++])&&n(b,h);for(var y in w)null==x[y]&&n(b,w[y])}}return b&&(d.element=b),d}function q(a,b,c){if("string"==typeof c&&(c=document.querySelector(c)),Array.isArray(b))throw new z;if(p(c,a&&a.element,a,b),b!==a)for(;0<y.length;)y.pop()();return b}function r(a,b){return s(a)||t(a,b)||u()}function s(a){if(Array.isArray(a))return a}function t(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function v(a){for(var b=Object.create(null),c=a=>a&&a.type,d=(a,b)=>(d,e)=>{var f=c(d),g=A.call(a,f)&&a[f];return g?g(d.data,e):b(e)},e=0,f=function(){var c=a[e];b[c]=a=>({type:c,data:a}),e++};e<a.length;)f();return{variants:b,match:function(a,b,c){return d(b,c)(a)}}}var w={},x=[],y=[];class z{constructor(){this.message="Cannot insert Fragment tag directly into DOM.",this.toString=function(){return this.message}}}var A=Object.prototype.hasOwnProperty;a.h=function(a,d){d=d||{};for(var e,f=[],g=[],h=arguments.length,i=Array(2<h?h-2:0),j=2;j<h;j++)i[j-2]=arguments[j];for(var k=i.length,l=Reflect.get(d,"key");0<k--;)f.push(i[k]);for(Reflect.get(d,"children")&&(0>=f.length&&f.push(d.children),delete d.children);0<f.length;)if(Array.isArray(e=f.pop()))for(var m=e.length;0<m--;)f.push(e[m]);else if(!1===e||!0===e||null==e);else g.push("object"==typeof e?e:c(e));return"function"==typeof a?a(d,d.children=g):b(a,d,g,null,l,1)},a.render=function(a,b,c){if(b="string"==typeof b?document.querySelector(b):b,!b)return console.error("@composi/core Error: You need to provide a valid container to render the component in. Check the element or selector you provided and make sure that it exists in the DOM before trying to render."),void console.error(`@composi/core Message: The container you provided was "${b}"`);var e;c?("string"==typeof c&&(c=document.querySelector(c)),e=d(c)):e=b&&Reflect.get(b,"vnode");var f=q(e,a,b);b.vnode=f},a.hydrate=d,a.run=function(a){function b(a){j&&c(f(d,a,b))}function c(c){var f,i=a.init();if(c){var j=r(c,2);d=j[0],e=j[1]}else if(i&&i.length){var l=r(i,2);d=l[0],e=l[1],h&&!k&&(f=h(d,b),"function"==typeof f&&f(d,b),k=!0)}else d=[];e&&e(d,b),g(d,b)}var d,e,f=a.update,g=a.view,h=a.subscriptions||a.subs,i=a.done,j=!0,k=!1;return a.send=b,c(d),()=>{j&&(j=!1,i&&i(d))}},a.union=function(a){var b=v(a),c=b.variants,d=b.match;return c.match=d,c},a.mapEffect=function(a,b){return c=>d=>e=>(c(b(e)),a(d))},a.batchEffects=a=>(b,c)=>a.map(a=>a&&a(b,c)),a.Fragment=(a,b)=>Array.isArray(a)&&!b?a:b,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=composi-core.js.map
