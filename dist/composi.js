(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.composi={})})(this,function(a){"use strict";function b(a,b,c,d,e,f){return{type:a,props:b,children:c,element:d,key:e,flag:f}}function c(a,c){return b(a,v,w,c,null,s)}function d(a){return"string"==typeof a&&(a=document.querySelector(a)),b(a.nodeName.toLowerCase(),v,w.map.call(a.childNodes,e),a,null,r)}function e(a){return 3===a.nodeType?c(a.nodeValue,a):d(a)}function f(...a){const b=a.map(a=>JSON.parse(JSON.stringify(a)));return b.reduce((c,a)=>Object.assign({},c,a))}function g(a){return"number"==typeof a&&isNaN(a)?"NaN":/\[object (.*)]/.exec(toString.call(a))[1]}function h(a){return a.currentTarget.events[a.type](a)}function i(a){return null==a?null:a.key}function j(a,b,c){const d={};let e,f;for(;b<=c;b++)null!=(e=(f=a[b]).key)&&(d[e]=f);return d}function k(a,b,c,d,e){if(c!==d)if("style"===b&&"Object"===g(d))for(let e in f(c,d)){const c=null==d||null==d[e]?"":d[e];"-"===e[0]?a[b].setProperty(e,c):a[b][e]=c}else if("key"!==b)if("className"===b&&(b="class"),"o"===b[0]&&"n"===b[1])a.events||(a.events={}),b=b.slice(2).toLowerCase(),c||(c=a.events[b]),a.events[b]=d,null==d?a.removeEventListener(b,h):null==c&&a.addEventListener(b,h);else{const c=null==d||!1===d||"no"===d||"off"===d;b in a&&"list"!==b&&"type"!==b&&"draggable"!==b&&"spellcheck"!==b&&"translate"!==b&&!e?(a[b]=null==d?"":d,c&&a.removeAttribute(b)):"xlink-href"===b||"xlinkHref"===b?(a.setAttributeNS(t,"href",d),a.setAttribute("href",d)):c?a.removeAttribute(b):a.setAttribute(b,d)}}function l(a,b,c){let d=a.flag===s?document.createTextNode(a.type):(c=c||"svg"===a.type)?document.createElementNS(u,a.type):document.createElement(a.type);const e=a.props;e.onmount&&b.push(function(){e.onmount(d)});for(let e=0,f=a.children.length;e<f;e++)d.appendChild(l(a.children[e],b,c));for(let f in e)k(d,f,null,e[f],c);return a.element=d}function m(a){for(let b=0,c=a.children.length;b<c;b++)m(a.children[b]);return a.element}function n(a,b){function c(){a&&a.nodeType&&a.removeChild(m(b))}const d=b.props&&b.props.onunmount;null==d?c():d(c,b.element)}function o(a,b,c,d,e,g){for(let h in f(b,c))("value"==h||"checked"==h?a[h]:b[h])!==c[h]&&k(a,h,b[h],c[h],e);const h=g?c.onmount:c.onupdate;null!=h&&d.push(function(){h(a,b,c)})}function p(a,b,c,d,e,f){if(d===c);else if(null!=c&&c.flag===s&&d.flag===s)c.type!==d.type&&(b.nodeValue=d.type);else if(null==c||c.type!==d.type){const g=a.insertBefore(l(d,e,f),b);null!=c&&n(a,c),b=g}else{o(b,c.props,d.props,e,f=f||"svg"===d.type,c.flag===r);let a,g,h;const k=c.children;let m,q=0,s=k.length-1;const t=d.children;let u=0,v=t.length-1;for(;u<=v&&q<=s&&(h=i(k[q]),m=i(t[u]),null!=h&&h===m);)p(b,k[q].element,k[q],t[u],e,f),q++,u++;for(;u<=v&&q<=s&&(h=i(k[s]),m=i(t[v]),null!=h&&h===m);)p(b,k[s].element,k[s],t[v],e,f),s--,v--;if(q>s)for(;u<=v;)b.insertBefore(l(t[u++],e,f),(g=k[q])&&g.element);else if(u>v)for(;q<=s;)n(b,k[q++]);else{let d=j(k,q,s);const l={};for(;u<=v;){if(h=i(g=k[q]),m=i(t[u]),l[h]||null!=m&&m===i(k[q+1])){null==h&&n(b,g),q++;continue}null==m||c.flag===r?(null==h&&(p(b,g&&g.element,g,t[u],e,f),u++),q++):(h===m?(p(b,g.element,g,t[u],e,f),l[m]=!0,q++):null==(a=d[m])?p(b,g&&g.element,null,t[u],e,f):(p(b,b.insertBefore(a.element,g&&g.element),a,t[u],e,f),l[m]=!0),u++)}for(;q<=s;)null==i(g=k[q++])&&n(b,g);for(let a in d)null==l[a]&&n(b,d[a])}}return d.element=b,d}function q(a,b,c){"string"==typeof b&&(b=document.querySelector(b));const d=[];if(!c){if(Array.isArray(a))throw new x;const c=l(a,d);b.appendChild(c),a.element=c}else p(b,c.element,c,a,d);if(a!==c)for(;0<d.length;)d.pop()();return a.element.isMounted=!0,a}const r=0,s=3,t="http://www.w3.org/1999/xlink",u="http://www.w3.org/2000/svg",v={},w=[];class x{constructor(){this.message="Cannot insert Fragment tag directly into DOM.",this.toString=function(){return this.message}}}a.h=function(a,d,...e){let f;const g=[],h=[];let i=e.length;d=d||{};const j=d.key;for(;0<i--;)g.push(e[i]);for(null!=d.children&&(0>=g.length&&g.push(d.children),delete d.children);0<g.length;)if(Array.isArray(f=g.pop()))for(i=f.length;0<i--;)g.push(f[i]);else if(!1===f||!0===f||null==f);else h.push("object"==typeof f?f:c(f));return delete d.key,"function"==typeof a?a(d,d.children=h):b(a,d,h,null,j,1)},a.render=function(a,b,c){return q(a,b,c)},a.unmount=function(a){function b(){a.element.parentNode.removeChild(a.element),a.element=null}a.props.onunmount?a.props.onunmount(b,a.element):b()},a.hydrate=d,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=composi.js.map
